/home/garrett/SCM/AttnGAN/code/miscc/config.py:107: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.
  yaml_cfg = edict(yaml.load(f))
Using config:
{'B_VALIDATION': False,
 'CONFIG_NAME': 'DAMSM',
 'CUDA': True,
 'DATASET_NAME': 'photosynthesis',
 'DATA_DIR': 'data/photosynthesis',
 'DELETE_CAPTIONS_PICKLE': True,
 'GAN': {'B_ATTENTION': True,
         'B_DCGAN': False,
         'CONDITION_DIM': 100,
         'DF_DIM': 64,
         'GF_DIM': 128,
         'R_NUM': 2,
         'Z_DIM': 100},
 'GPU_ID': 0,
 'OUTPUT_DIR': 'output',
 'RNN_TYPE': 'LSTM',
 'TEXT': {'CAPTIONS_PER_IMAGE': 1, 'EMBEDDING_DIM': 128, 'WORDS_NUM': 244},
 'TRAIN': {'BATCH_SIZE': 3,
           'B_NET_D': True,
           'DISCRIMINATOR_LR': 0.0002,
           'ENCODER_LR': 0.003189,
           'FLAG': True,
           'GENERATOR_LR': 0.0002,
           'MAX_EPOCH': 1,
           'NET_E': '',
           'NET_G': '',
           'RNN_GRAD_CLIP': 2.0,
           'SMOOTH': {'GAMMA1': 72.4953,
                      'GAMMA2': 65.3585,
                      'GAMMA3': 89.2507,
                      'LAMBDA': 1.0},
           'SNAPSHOT_INTERVAL': 100},
 'TRAIN_SPLIT': 1.0,
 'TREE': {'BASE_SIZE': 5, 'BRANCH_NUM': 1},
 'VALIDATION_SPLIT': 1.0,
 'WORKERS': 1}
data/photosynthesis/filenames.txt
Number of Train files: 7
Number of Test files: 7
INFO: [root] Number of text files: 7
DEBUG: [root] Deleting file: data/photosynthesis/captions.pickle
DEBUG: [root] splitType: test 
DEBUG: [root] Deleting file: data/photosynthesis/test/filenames.pickle
DEBUG: [root] Number of items in pickled list: 7
DEBUG: [root] splitType: train 
DEBUG: [root] Deleting file: data/photosynthesis/train/filenames.pickle
DEBUG: [root] Number of items in pickled list: 7
INFO: [root] FINISHED WRITING TEXT TO <<{'test': 'data/photosynthesis/test/filenames.pickle', 'train': 'data/photosynthesis/train/filenames.pickle'}>>
Split Directory: data/photosynthesis/train
Load filenames from: data/photosynthesis/train/filenames.pickle (7)
Load filenames from: data/photosynthesis/test/filenames.pickle (7)
DEBUG: [root] data_dir: data/photosynthesis
DEBUG: [root] Check if captions.pickle does not exists
Save to:  data/photosynthesis/captions.pickle
DEBUG: [root] data_dir: data/photosynthesis
data_dir Directory: data/photosynthesis
Number words: 244
Embedding Number: 1
Split Directory: data/photosynthesis/test
Load filenames from: data/photosynthesis/train/filenames.pickle (7)
Load filenames from: data/photosynthesis/test/filenames.pickle (7)
Load from:  data/photosynthesis/captions.pickle
data_dir Directory: data/photosynthesis
DEBUG: [root] Check if captions.pickle does not exists
DEBUG: [root] captions.pickle exists
DEBUG: [root] Loading pickle text file names: data/photosynthesis/captions.pickle
/home/garrett/SCM/AttnGAN/code/env/lib/python3.5/site-packages/torch/nn/modules/rnn.py:46: UserWarning: dropout option adds dropout after all but last recurrent layer, so non-zero dropout expects num_layers greater than 1, but got dropout=0.5 and num_layers=1
  "num_layers={}".format(dropout, num_layers))
Load pretrained model from  https://download.pytorch.org/models/inception_v3_google-1a9a5a14.pth
| epoch   0 |     0/    2 batches | ms/batch 19.61 | s_loss  0.02  0.03 | w_loss  1.61  2.28
att_sze equal to 17
DEBUG: [PIL.PngImagePlugin] STREAM b'IHDR' 16 13
DEBUG: [PIL.PngImagePlugin] STREAM b'IDAT' 41 1216
-----------------------------------------------------------------------------------------
| end epoch   0 | valid loss 18.21 708.57 | lr 0.00319|
-----------------------------------------------------------------------------------------
Save G/Ds models.
